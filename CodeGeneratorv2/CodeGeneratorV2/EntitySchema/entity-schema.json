{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["entities"],
  "properties": {
    "entities": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "tableName", "properties"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Entity class name"
          },
          "tableName": {
            "type": "string",
            "description": "Database table name"
          },
          "schema": {
            "type": "string",
            "description": "Database schema (e.g., 'dbo', 'sales')"
          },
          "properties": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["name", "type"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Property name"
                },
                "columnName": {
                  "type": "string",
                  "description": "Database column name (if different from property name)"
                },
                "type": {
                  "type": "string",
                  "enum": [
                    "int", "long", "short", "byte",
                    "string", "char",
                    "decimal", "double", "float",
                    "bool",
                    "DateTime", "DateTimeOffset", "TimeSpan", "DateOnly", "TimeOnly",
                    "Guid",
                    "byte[]",
                    "int?", "long?", "short?", "byte?",
                    "decimal?", "double?", "float?",
                    "bool?",
                    "DateTime?", "DateTimeOffset?", "TimeSpan?", "DateOnly?", "TimeOnly?",
                    "Guid?"
                  ],
                  "description": "Data type (use ? suffix for nullable value types)"
                },
                "columnType": {
                  "type": "string",
                  "description": "Specific database column type (e.g., 'varchar(50)', 'nvarchar(max)', 'money')"
                },
                "isPrimaryKey": {
                  "type": "boolean",
                  "description": "Indicates if this is a primary key"
                },
                "isRequired": {
                  "type": "boolean",
                  "description": "Indicates if this property is required (NOT NULL)"
                },
                "maxLength": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Maximum length for string types"
                },
                "precision": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Precision for decimal/numeric types"
                },
                "scale": {
                  "type": "integer",
                  "minimum": 0,
                  "description": "Scale for decimal/numeric types"
                },
                "isUnicode": {
                  "type": "boolean",
                  "description": "Whether string uses Unicode (nvarchar vs varchar)"
                },
                "isFixedLength": {
                  "type": "boolean",
                  "description": "Whether string is fixed length (char/nchar vs varchar/nvarchar)"
                },
                "defaultValue": {
                  "description": "Default value for the column"
                },
                "defaultValueSql": {
                  "type": "string",
                  "description": "SQL expression for default value (e.g., 'GETDATE()', 'NEWID()')"
                },
                "computedColumnSql": {
                  "type": "string",
                  "description": "SQL expression for computed column"
                },
                "isStored": {
                  "type": "boolean",
                  "description": "Whether computed column is stored (persisted)"
                },
                "valueGeneratedOnAdd": {
                  "type": "boolean",
                  "description": "Value is generated when entity is added (e.g., IDENTITY)"
                },
                "valueGeneratedOnAddOrUpdate": {
                  "type": "boolean",
                  "description": "Value is generated on add or update (e.g., rowversion)"
                },
                "valueGeneratedNever": {
                  "type": "boolean",
                  "description": "Value is never generated by the database"
                },
                "isConcurrencyToken": {
                  "type": "boolean",
                  "description": "Used for optimistic concurrency (e.g., rowversion, timestamp)"
                },
                "comment": {
                  "type": "string",
                  "description": "Database column comment/description"
                },
                "collation": {
                  "type": "string",
                  "description": "Database collation (e.g., 'SQL_Latin1_General_CP1_CI_AS')"
                }
              },
              "additionalProperties": false
            }
          },
          "indexes": {
            "type": "array",
            "description": "Table indexes",
            "items": {
              "type": "object",
              "required": ["properties"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Index name"
                },
                "properties": {
                  "type": "array",
                  "minItems": 1,
                  "items": {
                    "type": "string"
                  },
                  "description": "Property names included in the index"
                },
                "isUnique": {
                  "type": "boolean",
                  "description": "Whether this is a unique index"
                },
                "isClustered": {
                  "type": "boolean",
                  "description": "Whether this is a clustered index"
                },
                "filter": {
                  "type": "string",
                  "description": "Filter expression for filtered index (e.g., 'IsDeleted = 0')"
                },
                "includeProperties": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Properties to include in index (covering index)"
                },
                "descending": {
                  "type": "array",
                  "items": {
                    "type": "boolean"
                  },
                  "description": "Array indicating sort direction for each property (true = descending)"
                }
              },
              "additionalProperties": false
            }
          },
          "relationships": {
            "type": "array",
            "description": "Entity relationships (navigation properties)",
            "items": {
              "type": "object",
              "required": ["navigationProperty", "relatedEntity", "relationshipType"],
              "properties": {
                "navigationProperty": {
                  "type": "string",
                  "description": "Navigation property name"
                },
                "relatedEntity": {
                  "type": "string",
                  "description": "Related entity name"
                },
                "relationshipType": {
                  "type": "string",
                  "enum": ["OneToMany", "ManyToOne", "OneToOne", "ManyToMany"],
                  "description": "Type of relationship"
                },
                "foreignKey": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Foreign key property name(s)"
                },
                "principalKey": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Principal key property name(s) in related entity"
                },
                "inverseProperty": {
                  "type": "string",
                  "description": "Inverse navigation property name in related entity"
                },
                "onDelete": {
                  "type": "string",
                  "enum": ["Cascade", "Restrict", "NoAction", "SetNull", "ClientSetNull"],
                  "description": "Delete behavior"
                },
                "isRequired": {
                  "type": "boolean",
                  "description": "Whether the relationship is required"
                },
                "joinTable": {
                  "type": "string",
                  "description": "Join table name for many-to-many (if custom)"
                },
                "joinSchema": {
                  "type": "string",
                  "description": "Join table schema for many-to-many"
                }
              },
              "additionalProperties": false
            }
          },
          "checkConstraints": {
            "type": "array",
            "description": "Table check constraints",
            "items": {
              "type": "object",
              "required": ["name", "sql"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Constraint name"
                },
                "sql": {
                  "type": "string",
                  "description": "SQL constraint expression (e.g., 'Price > 0')"
                }
              },
              "additionalProperties": false
            }
          },
          "comment": {
            "type": "string",
            "description": "Table comment/description"
          },
          "isTemporalTable": {
            "type": "boolean",
            "description": "Whether this is a SQL Server temporal table"
          },
          "temporalTableConfiguration": {
            "type": "object",
            "description": "Temporal table configuration",
            "properties": {
              "historyTableName": {
                "type": "string",
                "description": "History table name"
              },
              "historyTableSchema": {
                "type": "string",
                "description": "History table schema"
              },
              "periodStartProperty": {
                "type": "string",
                "description": "Period start column name"
              },
              "periodEndProperty": {
                "type": "string",
                "description": "Period end column name"
              }
            },
            "additionalProperties": false
          },
          "discriminator": {
            "type": "object",
            "description": "Table-per-hierarchy inheritance discriminator",
            "properties": {
              "property": {
                "type": "string",
                "description": "Discriminator column name"
              },
              "value": {
                "description": "Discriminator value for this entity"
              },
              "isComplete": {
                "type": "boolean",
                "description": "Whether the discriminator mapping is complete"
              }
            },
            "additionalProperties": false
          },
          "baseEntity": {
            "type": "string",
            "description": "Base entity name for inheritance"
          },
          "isAbstract": {
            "type": "boolean",
            "description": "Whether this is an abstract entity"
          },
          "isOwned": {
            "type": "boolean",
            "description": "Whether this is an owned entity type"
          },
          "ownedNavigations": {
            "type": "array",
            "description": "Owned entity navigations",
            "items": {
              "type": "object",
              "required": ["navigationProperty", "ownedType"],
              "properties": {
                "navigationProperty": {
                  "type": "string",
                  "description": "Navigation property name"
                },
                "ownedType": {
                  "type": "string",
                  "description": "Owned entity type name"
                },
                "isList": {
                  "type": "boolean",
                  "description": "Whether this is a collection of owned entities"
                }
              },
              "additionalProperties": false
            }
          },
          "triggerNames": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Database trigger names associated with this table"
          },
          "excludeFromMigrations": {
            "type": "boolean",
            "description": "Whether to exclude this entity from migrations"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}